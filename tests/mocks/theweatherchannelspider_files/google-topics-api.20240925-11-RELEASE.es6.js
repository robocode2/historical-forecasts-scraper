/*! 20240925-11-RELEASE */

(o=>{const e="top",t="https://cdn.taboola.com",i="http://localhost:9876",n=`${t}/libtrc/static/topics/taboola-browsing-topics.html`,r=`tbl-browsing-topics-iframe-${100*Math.random()}`;function s(){try{if(!TRC.topics)return;c(TRC.topics)}catch(o){__trcWarn(`failed to save handed Google Topics at local storage: ${o.message}`)}}function c(o){try{const t=a()||[];for(let e=0;e<o.length;e++){const i=o[e],n=t.some(o=>o.topic===i.topic);if(!n){const o={topic:i.topic,taxonomy:i.taxonomyVersion,model:i.modelVersion,config:i.configVersion,version:i.version};t.push(o)}}if(!t.length)return;TRC.pageManager.storeValue(e,JSON.stringify(t)),m()}catch(o){__trcWarn(`failed to save Google Topics at local storage: ${o.message}`)}}function a(){let o,t;try{if((t=(o=TRC.pageManager.getValue(e))?JSON.parse(o):null)&&t.length>0){const o=l(t);return o}}catch(o){__trcWarn(`failed to read Google Topics from local storage: ${o.message}`)}}function l(o){let t=!1;return o.forEach((e,i)=>{(e.i||e.v||!e.version)&&(t=!0,o.splice(i,1))}),t&&TRC.pageManager.storeValue(e,JSON.stringify(o)),o}function g(){window.addEventListener("message",o=>{if(o.origin!==t&&o.origin!==i)return;const e=o.data;e.error&&__trcWarn(`Error in browsing topics iframe: ${e.error}`),e.policyMessage&&__trcWarn(e.policyMessage),e.topics&&e.topics.length&&c(e.topics)})}function p(){const e=new MutationObserver(o=>{o.forEach(o=>{o.addedNodes.forEach(o=>{"BODY"===o.nodeName&&(e.disconnect(),d())})})});e.observe(o.documentElement,{childList:!0,subtree:!1})}function d(){if(!o.body)return void p();const e=o.createElement("iframe");e.id=r,e.src=n,e.style.width="0",e.style.height="0",e.style.display="none",g(),o.body.appendChild(e)}function f(){return"browsingTopics"in o&&o.featurePolicy&&o.featurePolicy.allowsFeature("browsing-topics")}function u(){f()&&d()}function m(){const e=o.getElementById(r);e&&e.remove()}s(),u(),TRC.GoogleTopicsApi={readGoogleTopicsApiFromLocalStorage:a},window._trcIsUTactive&&(TRC.GoogleTopicsApi.testHelpers={browsingTopicsTestPromise:()=>(s(),d(),new Promise(o=>{window.addEventListener("message",e=>{e.origin===i&&e.data.topics&&o(a())})}))})})(document);